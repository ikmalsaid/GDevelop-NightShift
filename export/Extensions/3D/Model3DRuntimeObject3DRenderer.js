var gdjs;(function(o){class h extends o.RuntimeObject3DRenderer{constructor(t,e){const s=e.getGame().getModel3DManager().getModel(t._modelResourceName).clone(),n=new THREE.Group;n.rotation.order="ZYX",n.add(s);super(t,e,n);this._model3DRuntimeObject=t,this._threeObject=s,this.updateSize(),this.updatePosition(),this.updateRotation()}_updateDefaultTransformation(t,e,a,s,n,M,R){const i=this._getModelAABB(t,e,a);this._threeObject.position.set(-(i.min.x+i.max.x)/2,this._threeObject.position.y=-(i.min.y+i.max.y)/2,this._threeObject.position.z=-(i.min.z+i.max.z)/2),this._threeObject.scale.set(1,1,1),this._threeObject.rotation.set(o.toRad(t),o.toRad(e),o.toRad(a));const r=i.max.x-i.min.x,l=i.max.y-i.min.y,c=i.max.z-i.min.z,b=1/r,j=1/l,O=1/c,d=new THREE.Matrix4;if(d.makeScale(b,j,O),this._threeObject.updateMatrix(),this._threeObject.applyMatrix4(d),R){const _=s/r,p=n/l,u=M/c,m=Math.min(_,p,u);this._object._setOriginalWidth(m*r),this._object._setOriginalHeight(m*l),this._object._setOriginalDepth(m*c)}this._threeObject.updateMatrix()}_getModelAABB(t,e,a){const s=this._object.getInstanceContainer().getGame().getModel3DManager().getModel(this._model3DRuntimeObject._modelResourceName);s.rotation.set(o.toRad(t),o.toRad(e),o.toRad(a));const n=new THREE.Box3().setFromObject(s);return s.rotation.set(0,0,0),n}_updateMaterials(){const e=this._model3DRuntimeObject.getInstanceContainer().getGame().getModel3DManager().getModel(this._model3DRuntimeObject._modelResourceName).clone();this.get3DRendererObject().remove(this._threeObject),this.get3DRendererObject().add(e),this._threeObject=e,this._replaceMaterials()}_replaceMaterials(){this._model3DRuntimeObject._materialType===o.Model3DRuntimeObject.MaterialType.StandardWithoutMetalness?this._threeObject.traverse(t=>{if(t.type==="Mesh"){const a=t.material;a.metalness&&(a.metalness=0)}}):this._model3DRuntimeObject._materialType===o.Model3DRuntimeObject.MaterialType.Basic&&this._threeObject.traverse(t=>{if(t.type==="Mesh"){const e=t,a=new THREE.MeshBasicMaterial;e.material.color&&(a.color=e.material.color),e.material.map&&(a.map=e.material.map),e.material=a}})}}o.Model3DRuntimeObjectRenderer=h})(gdjs||(gdjs={}));
//# sourceMappingURL=Model3DRuntimeObject3DRenderer.js.map
